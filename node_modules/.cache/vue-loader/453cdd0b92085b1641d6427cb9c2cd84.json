{"remainingRequest":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liushaohua/Project/ssyx-web/ssyx-admin/src/views/acl/role/list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/src/views/acl/role/list.vue","mtime":1678517116000},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/cache-loader/dist/cjs.js","mtime":1688442891160},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/babel-loader/lib/index.js","mtime":1688442878961},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/cache-loader/dist/cjs.js","mtime":1688442891160},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/vue-loader/lib/index.js","mtime":1688442880248}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpleHBvcnQgZGVmYXVsdCB7CgogIG5hbWU6ICdSb2xlTGlzdCcsCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsaXN0TG9hZGluZzogdHJ1ZSwgLy8g5pWw5o2u5piv5ZCm5q2j5Zyo5Yqg6L29CiAgICAgIHJvbGVzOiBbXSwgLy8g6KeS6Imy5YiX6KGoCiAgICAgIHRvdGFsOiAwLCAvLyDmgLvorrDlvZXmlbAKICAgICAgcGFnZTogMSwgLy8g5b2T5YmN6aG156CBCiAgICAgIGxpbWl0OiA1LCAvLyDmr4/pobXorrDlvZXmlbAKICAgICAgdGVtcFNlYXJjaE9iajogeyAvLyDmlLbpm4bmkJzntKLmnaHku7bmlbDmja4KICAgICAgICByb2xlTmFtZTogJycsCiAgICAgIH0sCiAgICAgIHNlYXJjaE9iajogeyAvLyDlj5HpgIHor7fmsYLnmoTmnaHku7blj4LmlbDmlbDmja4KICAgICAgICByb2xlTmFtZTogJycsCiAgICAgIH0sCiAgICAgIHNlbGVjdGVkUm9sZXM6IFtdIC8vIOaJgOaciemAieS4reeahOinkuiJsuWIl+ihqAogICAgfQogIH0sCgogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldFJvbGVzKCkKICB9LAoKICBtZXRob2RzOiB7CgogICAgLyoKICAgIOWPlua2iOS/ruaUuQogICAgKi8KICAgIGNhbmNlbEVkaXQocm9sZSkgewogICAgICByb2xlLnJvbGVOYW1lID0gcm9sZS5vcmlnaW5Sb2xlTmFtZQogICAgICByb2xlLmVkaXQgPSBmYWxzZQogICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+WPlua2iOinkuiJsuS/ruaUuScpCiAgICB9LAoKICAgIC8qCiAgICDmm7TmlrDop5LoibIKICAgICovCiAgICB1cGRhdGVSb2xlIChyb2xlKSB7CiAgICAgIHRoaXMuJEFQSS5yb2xlLnVwZGF0ZUJ5SWQoe2lkOiByb2xlLmlkLCByb2xlTmFtZTogcm9sZS5yb2xlTmFtZX0pCiAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXN1bHQubWVzc2FnZXx8ICfmm7TmlrDop5LoibLmiJDlip8hJykKICAgICAgICAgIHRoaXMuZ2V0Um9sZXModGhpcy5wYWdlKQogICAgICAgIH0pCiAgICB9LAoKICAgIC8qCiAgICDmr4/pobXmlbDph4/lj5HnlJ/mlLnlj5jnmoTnm5HlkKwKICAgICovCiAgICBoYW5kbGVTaXplQ2hhbmdlKHBhZ2VTaXplKSB7CiAgICAgIHRoaXMubGltaXQgPSBwYWdlU2l6ZQogICAgICB0aGlzLmdldFJvbGVzKCkKICAgIH0sCgogICAgLyoKICAgIOa3u+WKoOinkuiJsgogICAgKi8KICAgIGFkZFJvbGUoKXsKICAgICAgLy8g5pi+56S65re75Yqg55WM6Z2iCiAgICAgIHRoaXMuJHByb21wdCgn6K+36L6T5YWl5paw5ZCN56ewJywgJ+a3u+WKoOinkuiJsicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgIH0pLnRoZW4oKHsgdmFsdWUgfSkgPT4gewogICAgICAgIHRoaXMuJEFQSS5yb2xlLnNhdmUoe3JvbGVOYW1lOiB2YWx1ZX0pLnRoZW4ocmVzdWx0ID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXN1bHQubWVzc2FnZSB8fCAn5re75Yqg6KeS6Imy5oiQ5YqfJykKICAgICAgICAgIHRoaXMuZ2V0Um9sZXMoKQogICAgICAgIH0pCiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+WPlua2iOa3u+WKoCcpCiAgICAgIH0pCiAgICB9LAoKICAgIC8qCiAgICDlvILmraXojrflj5bop5LoibLliIbpobXliJfooagKICAgICovCiAgICBnZXRSb2xlcyhwYWdlID0gMSkgewogICAgICB0aGlzLnBhZ2UgPSBwYWdlCiAgICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlCiAgICAgIGNvbnN0IHtsaW1pdCwgc2VhcmNoT2JqfSA9IHRoaXMKICAgICAgdGhpcy4kQVBJLnJvbGUuZ2V0UGFnZUxpc3QocGFnZSwgbGltaXQsIHNlYXJjaE9iaikudGhlbigKICAgICAgICByZXN1bHQgPT4gewogICAgICAgICAgY29uc3Qge3JlY29yZHMsIHRvdGFsfSA9IHJlc3VsdC5kYXRhCiAgICAgICAgICB0aGlzLnJvbGVzID0gcmVjb3Jkcy5tYXAoaXRlbSA9PiB7CiAgICAgICAgICAgIGl0ZW0uZWRpdCA9IGZhbHNlIC8vIOeUqOS6juagh+ivhuaYr+WQpuaYvuekuue8lui+kei+k+WFpeahhueahOWxnuaApwogICAgICAgICAgICBpdGVtLm9yaWdpblJvbGVOYW1lID0gaXRlbS5yb2xlTmFtZSAvLyDnvJPlrZjop5LoibLlkI3np7AsIOeUqOS6juWPlua2iAogICAgICAgICAgICByZXR1cm4gaXRlbQogICAgICAgICAgfSkKICAgICAgICAgIHRoaXMudG90YWwgPSB0b3RhbAogICAgICAgIH0KICAgICAgKS5maW5hbGx5KCgpID0+IHsKICAgICAgICB0aGlzLmxpc3RMb2FkaW5nID0gZmFsc2UKICAgICAgfSkKICAgIH0sCgogICAgLyoKICAgIOagueaNruaQnOe0ouadoeS7tui/m+ihjOaQnOe0ogogICAgKi8KICAgIHNlYXJjaCAoKSB7CiAgICAgIHRoaXMuc2VhcmNoT2JqID0gey4uLnRoaXMudGVtcFNlYXJjaE9ian0KICAgICAgdGhpcy5nZXRSb2xlcygpCiAgICB9LAoKICAgIC8qCiAgICDph43nva7mn6Xor6LooajljZXmkJzntKLliJfooagKICAgICovCiAgICByZXNldFNlYXJjaCgpIHsKICAgICAgdGhpcy50ZW1wU2VhcmNoT2JqID0gewogICAgICAgIHJvbGVOYW1lOiAnJwogICAgICB9CiAgICAgIHRoaXMuc2VhcmNoT2JqID0gewogICAgICAgIHJvbGVOYW1lOiAnJwogICAgICB9CiAgICAgIHRoaXMuZ2V0Um9sZXMoKQogICAgfSwKCiAgICAvKgogICAg5Yig6Zmk5oyH5a6a55qE6KeS6ImyCiAgICAqLwogICAgcmVtb3ZlUm9sZSAoe2lkLCByb2xlTmFtZX0pIHsKICAgICAgdGhpcy4kY29uZmlybShg56Gu5a6a5Yig6ZmkICcke3JvbGVOYW1lfScg5ZCXP2AsICfmj5DnpLonLCB7CiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJEFQSS5yb2xlLnJlbW92ZUJ5SWQoaWQpCiAgICAgICAgdGhpcy5nZXRSb2xlcyh0aGlzLnJvbGVzLmxlbmd0aD09PTEgPyB0aGlzLnBhZ2UtMSA6IHRoaXMucGFnZSkKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzdWx0Lm1lc3NhZ2UgfHwgJ+WIoOmZpOaIkOWKnyEnKQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5pbmZvKCflt7Llj5bmtojliKDpmaQnKQogICAgICB9KQogICAgfSwKCiAgICAvKgogICAg5b2T6KGo5qC85aSN6YCJ5qGG6YCJ6aG55Y+R55Sf5Y+Y5YyW55qE5pe25YCZ6Kem5Y+RCiAgICAqLwogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHNlbGVjdGlvbikgewogICAgICB0aGlzLnNlbGVjdGVkUm9sZXMgPSBzZWxlY3Rpb24KICAgIH0sCgogICAgLyoKICAgIOaJuemHj+WIoOmZpAogICAgKi8KICAgIHJlbW92ZVJvbGVzICgpIHsKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk6K+l6K6w5b2VLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbihhc3luYyAoKSA9PiB7CiAgICAgICAgY29uc3QgaWRzID0gdGhpcy5zZWxlY3RlZFJvbGVzLm1hcChyb2xlID0+IHJvbGUuaWQpCiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy4kQVBJLnJvbGUucmVtb3ZlUm9sZXMoaWRzKQogICAgICAgIHRoaXMuZ2V0Um9sZXMoKQogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgbWVzc2FnZTogJ+aJuemHj+WIoOmZpOaIkOWKnyEnCiAgICAgICAgfSkKICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7CgogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5Yig6ZmkJwogICAgICAgIH0pCiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/acl/role","sourcesContent":["<template>\n  <div>\n\n    <el-card class=\"operate-container\" shadow=\"never\">\n      <div style=\"margin-top: 15px\">\n        <el-form :inline=\"true\" size=\"small\" label-width=\"140px\">\n          <el-form-item label=\"输入搜索：\">\n            <el-input style=\"width: 203px\" v-model=\"tempSearchObj.roleName\" placeholder=\"角色名称\"></el-input>\n          </el-form-item>\n\n          <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"search()\">查询</el-button>\n          <el-button type=\"default\" @click=\"resetSearch()\">清空</el-button>\n        </el-form>\n      </div>\n    </el-card>\n\n    <!-- 工具条 -->\n    <el-card class=\"operate-container\" shadow=\"never\">\n      <i class=\"el-icon-tickets\" style=\"margin-top: 5px\"></i>\n      <span style=\"margin-top: 5px\">数据列表</span>\n\n      <el-button class=\"btn-add\" size=\"mini\" @click=\"addRole\">添加</el-button>\n      <el-button class=\"btn-add\" size=\"mini\" @click=\"removeRoles()\" :disabled=\"selectedRoles.length === 0\" style=\"margin: 0 10px;\">批量删除</el-button>\n    </el-card>\n\n    <el-table\n      border\n      stripe\n      v-loading=\"listLoading\"\n      :data=\"roles\"\n      @selection-change=\"handleSelectionChange\">\n\n      <el-table-column\n        type=\"selection\"\n        width=\"75\" />\n\n      <el-table-column\n        type=\"index\"\n        label=\"序号\"\n        width=\"100\"\n        align=\"center\">\n      </el-table-column>\n\n      <el-table-column label=\"角色名称\" width=\"500\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <template v-if=\"row.edit\">\n            <el-input v-model=\"row.roleName\" class=\"edit-input\" size=\"small\" />\n            <el-button\n              class=\"cancel-btn\"\n              size=\"small\"\n              icon=\"el-icon-refresh\"\n              type=\"warning\"\n              @click=\"cancelEdit(row)\"\n            >\n              取消\n            </el-button>\n          </template>\n          <span v-else>{{ row.roleName }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column label=\"操作\" align=\"center\">\n        <template slot-scope=\"{row}\">\n          <HintButton size=\"mini\" type=\"info\" icon=\"el-icon-info\" title=\"分配权限\"\n            @click=\"$router.push(`/acl/role/auth/${row.id}?roleName=${row.roleName}`)\"/>\n\n          <HintButton size=\"mini\" type=\"primary\" icon=\"el-icon-check\" title=\"确定\"\n            @click=\"updateRole(row)\" v-if=\"row.edit\"/>\n          <HintButton size=\"mini\" type=\"primary\" icon=\"el-icon-edit\" title=\"修改角色\"\n            @click=\"row.edit= true\" v-if=\"!row.edit\" />\n          <HintButton size=\"mini\" type=\"danger\" icon=\"el-icon-delete\" title=\"删除角色\"\n            @click=\"removeRole(row)\"/>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <!-- 分页组件 -->\n    <el-pagination\n      :current-page=\"page\"\n      :total=\"total\"\n      :page-size=\"limit\"\n      :page-sizes=\"[5, 10, 20]\"\n      style=\"padding: 10px;\"\n      layout=\"prev, pager, next, jumper, ->, sizes, total\"\n      @current-change=\"getRoles\"\n      @size-change=\"handleSizeChange\"\n    />\n  </div>\n</template>\n\n<script>\n\nexport default {\n\n  name: 'RoleList',\n\n  data() {\n    return {\n      listLoading: true, // 数据是否正在加载\n      roles: [], // 角色列表\n      total: 0, // 总记录数\n      page: 1, // 当前页码\n      limit: 5, // 每页记录数\n      tempSearchObj: { // 收集搜索条件数据\n        roleName: '',\n      },\n      searchObj: { // 发送请求的条件参数数据\n        roleName: '',\n      },\n      selectedRoles: [] // 所有选中的角色列表\n    }\n  },\n\n  mounted() {\n    this.getRoles()\n  },\n\n  methods: {\n\n    /*\n    取消修改\n    */\n    cancelEdit(role) {\n      role.roleName = role.originRoleName\n      role.edit = false\n      this.$message.warning('取消角色修改')\n    },\n\n    /*\n    更新角色\n    */\n    updateRole (role) {\n      this.$API.role.updateById({id: role.id, roleName: role.roleName})\n        .then(result => {\n          this.$message.success(result.message|| '更新角色成功!')\n          this.getRoles(this.page)\n        })\n    },\n\n    /*\n    每页数量发生改变的监听\n    */\n    handleSizeChange(pageSize) {\n      this.limit = pageSize\n      this.getRoles()\n    },\n\n    /*\n    添加角色\n    */\n    addRole(){\n      // 显示添加界面\n      this.$prompt('请输入新名称', '添加角色', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n      }).then(({ value }) => {\n        this.$API.role.save({roleName: value}).then(result => {\n          this.$message.success(result.message || '添加角色成功')\n          this.getRoles()\n        })\n      }).catch(() => {\n        this.$message.warning('取消添加')\n      })\n    },\n\n    /*\n    异步获取角色分页列表\n    */\n    getRoles(page = 1) {\n      this.page = page\n      this.listLoading = true\n      const {limit, searchObj} = this\n      this.$API.role.getPageList(page, limit, searchObj).then(\n        result => {\n          const {records, total} = result.data\n          this.roles = records.map(item => {\n            item.edit = false // 用于标识是否显示编辑输入框的属性\n            item.originRoleName = item.roleName // 缓存角色名称, 用于取消\n            return item\n          })\n          this.total = total\n        }\n      ).finally(() => {\n        this.listLoading = false\n      })\n    },\n\n    /*\n    根据搜索条件进行搜索\n    */\n    search () {\n      this.searchObj = {...this.tempSearchObj}\n      this.getRoles()\n    },\n\n    /*\n    重置查询表单搜索列表\n    */\n    resetSearch() {\n      this.tempSearchObj = {\n        roleName: ''\n      }\n      this.searchObj = {\n        roleName: ''\n      }\n      this.getRoles()\n    },\n\n    /*\n    删除指定的角色\n    */\n    removeRole ({id, roleName}) {\n      this.$confirm(`确定删除 '${roleName}' 吗?`, '提示', {\n        type: 'warning'\n      }).then(async () => {\n        const result = await this.$API.role.removeById(id)\n        this.getRoles(this.roles.length===1 ? this.page-1 : this.page)\n        this.$message.success(result.message || '删除成功!')\n      }).catch(() => {\n        this.$message.info('已取消删除')\n      })\n    },\n\n    /*\n    当表格复选框选项发生变化的时候触发\n    */\n    handleSelectionChange(selection) {\n      this.selectedRoles = selection\n    },\n\n    /*\n    批量删除\n    */\n    removeRoles () {\n      this.$confirm('此操作将永久删除该记录, 是否继续?', '提示', {\n        type: 'warning'\n      }).then(async () => {\n        const ids = this.selectedRoles.map(role => role.id)\n        const result = await this.$API.role.removeRoles(ids)\n        this.getRoles()\n        this.$message({\n          type: 'success',\n          message: '批量删除成功!'\n        })\n      }).then((result) => {\n\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.edit-input {\n  padding-right: 100px;\n}\n.cancel-btn {\n  position: absolute;\n  right: 15px;\n  top: 10px;\n}\n</style>\n"]}]}