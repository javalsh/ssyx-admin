{"remainingRequest":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/babel-loader/lib/index.js!/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liushaohua/Project/ssyx-web/ssyx-admin/src/views/activity/couponInfo/rule.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/src/views/activity/couponInfo/rule.vue","mtime":1678846942000},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/babel.config.js","mtime":1637306514000},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/cache-loader/dist/cjs.js","mtime":1688442891160},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/babel-loader/lib/index.js","mtime":1688442878961},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/cache-loader/dist/cjs.js","mtime":1688442891160},{"path":"/Users/liushaohua/Project/ssyx-web/ssyx-admin/node_modules/vue-loader/lib/index.js","mtime":1688442880248}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBhcGkgZnJvbSAnQC9hcGkvYWN0aXZpdHkvY291cG9uSW5mbyc7CmltcG9ydCBhY3Rpdml0eUluZm9BcGkgZnJvbSAnQC9hcGkvYWN0aXZpdHkvYWN0aXZpdHlJbmZvJzsKaW1wb3J0IGNhdGVnb3J5QXBpIGZyb20gJ0AvYXBpL3Byb2R1Y3QvY2F0ZWdvcnknOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3RMb2FkaW5nOiBmYWxzZSwKICAgICAgLy8g5pWw5o2u5piv5ZCm5q2j5Zyo5Yqg6L29CgogICAgICBjb3Vwb25JbmZvOiB7fSwKICAgICAgc2F2ZUJ0bkRpc2FibGVkOiBmYWxzZSwKICAgICAgLy8g5LyY5oOg5Yi46IyD5Zu077yaU1BVCiAgICAgIGRpYWxvZ1NrZHVSYW5nVmlzaWJsZTogZmFsc2UsCiAgICAgIGtleXdvcmQ6ICcnLAogICAgICBza3VJbmZvTGlzdDogW10sCiAgICAgIC8vIOS8mOaDoOWIuOiMg+WbtO+8muS4iee6p+WIhuexuwogICAgICBkaWFsb2dDYXRlUmFuZ1Zpc2libGU6IGZhbHNlLAogICAgICBjYXRlZ29yeUxpc3Q6IFtdLAogICAgICBzZWxlY3RDYXRlZ29yeUxpc3Q6IFtdCiAgICB9OwogIH0sCiAgLy8g55uR5ZCs5ZmoCiAgd2F0Y2g6IHsKICAgICRyb3V0ZTogZnVuY3Rpb24gJHJvdXRlKHRvLCBmcm9tKSB7CiAgICAgIGNvbnNvbGUubG9nKCfot6/nlLHlj5jljJYuLi4uLi4nKTsKICAgICAgY29uc29sZS5sb2codG8pOwogICAgICBjb25zb2xlLmxvZyhmcm9tKTsKICAgICAgdGhpcy5pbml0KCk7CiAgICB9CiAgfSwKICAvLyDnlJ/lkb3lkajmnJ/mlrnms5XvvIjlnKjot6/nlLHliIfmjaLvvIznu4Tku7bkuI3lj5jnmoTmg4XlhrXkuIvkuI3kvJrooqvosIPnlKjvvIkKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgY29uc29sZS5sb2coJ2Zvcm0gY3JlYXRlZCAuLi4uLi4nKTsKICAgIHRoaXMuaW5pdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgLy8g6KGo5Y2V5Yid5aeL5YyWCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICB2YXIgY291cG9uSWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgIC8vIOiOt+WPluS8mOaDoOWIuOS/oeaBrwogICAgICB0aGlzLmZldGNoRGF0YUJ5SWQoY291cG9uSWQpOwoKICAgICAgLy8g6I635Y+W5LyY5oOg5Yi46KeE5YiZ5LiO6IyD5Zu05L+h5oGvCiAgICAgIHRoaXMuZmV0Y2hSdWxlRGF0YUJ5SWQoY291cG9uSWQpOwogICAgICB0aGlzLmZldGNoQ2F0ZWdvcnlMaXN0KCk7CiAgICB9LAogICAgZmV0Y2hDYXRlZ29yeUxpc3Q6IGZ1bmN0aW9uIGZldGNoQ2F0ZWdvcnlMaXN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBjYXRlZ29yeUFwaS5maW5kQWxsTGlzdCgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMuc2VsZWN0Q2F0ZWdvcnlMaXN0ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5o+Q5Lqk5L+d5a2Y5pWw5o2uCiAgICBzYXZlOiBmdW5jdGlvbiBzYXZlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdmFyIHJhbmdlRGVzYyA9ICflj6/otK3kubAnOwogICAgICB2YXIgY291cG9uUmFuZ2VMaXN0ID0gW107CiAgICAgIGlmICh0aGlzLmNvdXBvbkluZm8ucmFuZ2VUeXBlID09PSAnU0tVJykgewogICAgICAgIHRoaXMuc2t1SW5mb0xpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmFuZ2VEZXNjICs9ICfvvJonOwogICAgICAgICAgY291cG9uUmFuZ2VMaXN0LnB1c2goewogICAgICAgICAgICByYW5nZVR5cGU6ICdTS1UnLAogICAgICAgICAgICByYW5nZUlkOiBpdGVtLmlkCiAgICAgICAgICB9KTsKICAgICAgICAgIHJhbmdlRGVzYyArPSBpdGVtLnNwdU5hbWUgKyAnLCc7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuY291cG9uSW5mby5yYW5nZVR5cGUgPT09ICdDQVRFR09SWScpIHsKICAgICAgICByYW5nZURlc2MgKz0gJ+WIhuexu++8mic7CiAgICAgICAgdGhpcy5jYXRlZ29yeUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgY291cG9uUmFuZ2VMaXN0LnB1c2goewogICAgICAgICAgICByYW5nZVR5cGU6ICdDQVRFR09SWScsCiAgICAgICAgICAgIHJhbmdlSWQ6IGl0ZW0uaWQKICAgICAgICAgIH0pOwogICAgICAgICAgcmFuZ2VEZXNjICs9IGl0ZW0ubmFtZSArICcsJzsKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAodGhpcy5jb3Vwb25JbmZvLnJhbmdlVHlwZSA9PT0gJ0FMTCcpIHsKICAgICAgICByYW5nZURlc2MgKz0gJ+WFqOWcuumAmueUqCwnOwogICAgICB9CiAgICAgIGlmIChyYW5nZURlc2MubGVuZ3RoID4gMykgewogICAgICAgIHJhbmdlRGVzYyA9IHJhbmdlRGVzYy5zdWJzdHJpbmcoMCwgcmFuZ2VEZXNjLmxlbmd0aCAtIDEpOwogICAgICB9IGVsc2UgewogICAgICAgIHJhbmdlRGVzYyA9IHRoaXMuY291cG9uSW5mby5jb3Vwb25OYW1lOwogICAgICB9CiAgICAgIHZhciBydWxlRGF0YSA9IHsKICAgICAgICBjb3Vwb25JZDogdGhpcy5jb3Vwb25JbmZvLmlkLAogICAgICAgIHJhbmdlVHlwZTogdGhpcy5jb3Vwb25JbmZvLnJhbmdlVHlwZSwKICAgICAgICBhbW91bnQ6IHRoaXMuY291cG9uSW5mby5hbW91bnQsCiAgICAgICAgY29uZGl0aW9uQW1vdW50OiB0aGlzLmNvdXBvbkluZm8uY29uZGl0aW9uQW1vdW50LAogICAgICAgIGNvdXBvblJhbmdlTGlzdDogY291cG9uUmFuZ2VMaXN0LAogICAgICAgIHJhbmdlRGVzYzogcmFuZ2VEZXNjCiAgICAgIH07CiAgICAgIGFwaS5zYXZlQ291cG9uUnVsZShydWxlRGF0YSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczIuJG1lc3NhZ2Uuc3VjY2VzcyhyZXNwb25zZS5tZXNzYWdlKTsKICAgICAgICBfdGhpczIuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIHBhdGg6ICcvYWN0aXZpdHkvY291cG9uSW5mby9saXN0JwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICByZW1vdmVEYXRhQnlJZDogZnVuY3Rpb24gcmVtb3ZlRGF0YUJ5SWQoaW5kZXgpIHsKICAgICAgdGhpcy5hY3Rpdml0eVJ1bGVMaXN0LnNwbGljZShpbmRleCwgMSk7CiAgICB9LAogICAgYmFjazogZnVuY3Rpb24gYmFjaygpIHsKICAgICAgLy8gdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAnL2FjdGl2aXR5L2NvdXBvbkluZm8vbGlzdCcgfSkKICAgICAgd2luZG93Lmhpc3RvcnkuZ28oLTEpOwogICAgfSwKICAgIGZldGNoUnVsZURhdGFCeUlkOiBmdW5jdGlvbiBmZXRjaFJ1bGVEYXRhQnlJZChpZCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgYXBpLmZpbmRDb3Vwb25SdWxlTGlzdChpZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczMuc2t1SW5mb0xpc3QgPSByZXNwb25zZS5kYXRhLnNrdUluZm9MaXN0IHx8IFtdOwogICAgICAgIF90aGlzMy5jYXRlZ29yeUxpc3QgPSByZXNwb25zZS5kYXRhLmNhdGVnb3J5TGlzdCB8fCBbXTsKICAgICAgICBfdGhpczMudHJhZGVtYXJrTGlzdCA9IHJlc3BvbnNlLmRhdGEudHJhZGVtYXJrTGlzdCB8fCBbXTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5qC55o2uaWTmn6Xor6LorrDlvZUKICAgIGZldGNoRGF0YUJ5SWQ6IGZ1bmN0aW9uIGZldGNoRGF0YUJ5SWQoaWQpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIGFwaS5nZXRCeUlkKGlkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIC8vCiAgICAgICAgX3RoaXM0LmNvdXBvbkluZm8gPSByZXNwb25zZS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBxdWVyeVNrdVNlYXJjaDogZnVuY3Rpb24gcXVlcnlTa3VTZWFyY2gocXVlcnlTdHJpbmcsIGNiKSB7CiAgICAgIGNvbnNvbGUubG9nKHF1ZXJ5U3RyaW5nKTsKICAgICAgY29uc29sZS5sb2coY2IpOwogICAgICBhY3Rpdml0eUluZm9BcGkuZmluZFNrdUluZm9CeUtleXdvcmQocXVlcnlTdHJpbmcpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgLy8g6LCD55SoIGNhbGxiYWNrIOi/lOWbnuW7uuiuruWIl+ihqOeahOaVsOaNrgogICAgICAgIGNiKHJlc3BvbnNlLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBzZWxlY3RTa3VEYXRhOiBmdW5jdGlvbiBzZWxlY3RTa3VEYXRhKGl0ZW0pIHsKICAgICAgdGhpcy5za3VJbmZvTGlzdC5wdXNoKGl0ZW0pOwogICAgICB0aGlzLmRpYWxvZ1NrZHVSYW5nVmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIHJlbW92ZVNrdURhdGFCeUlkOiBmdW5jdGlvbiByZW1vdmVTa3VEYXRhQnlJZChpbmRleCkgewogICAgICB0aGlzLnNrdUluZm9MaXN0LnNwbGljZShpbmRleCwgMSk7CiAgICB9LAogICAgc2VsZWN0Q2F0ZWdvcnk6IGZ1bmN0aW9uIHNlbGVjdENhdGVnb3J5KGNhdGVnb3J5SWQpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIGNvbnNvbGUubG9nKGNhdGVnb3J5SWQpOwogICAgICBjYXRlZ29yeUFwaS5nZXRCeUlkKGNhdGVnb3J5SWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM1LmNhdGVnb3J5TGlzdC5wdXNoKHsKICAgICAgICAgIGlkOiBjYXRlZ29yeUlkLAogICAgICAgICAgbmFtZTogcmVzcG9uc2UuZGF0YS5uYW1lCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLmRpYWxvZ0NhdGVSYW5nVmlzaWJsZSA9IGZhbHNlOwogICAgfSwKICAgIHJlbW92ZUNhdGVEYXRhQnlJZDogZnVuY3Rpb24gcmVtb3ZlQ2F0ZURhdGFCeUlkKGluZGV4KSB7CiAgICAgIHRoaXMuY2F0ZWdvcnlMaXN0LnNwbGljZShpbmRleCwgMSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["api","activityInfoApi","categoryApi","data","listLoading","couponInfo","saveBtnDisabled","dialogSkduRangVisible","keyword","skuInfoList","dialogCateRangVisible","categoryList","selectCategoryList","watch","$route","to","from","console","log","init","created","methods","couponId","params","id","fetchDataById","fetchRuleDataById","fetchCategoryList","_this","findAllList","then","response","save","_this2","rangeDesc","couponRangeList","rangeType","forEach","item","push","rangeId","spuName","name","length","substring","couponName","ruleData","amount","conditionAmount","saveCouponRule","$message","success","message","$router","path","removeDataById","index","activityRuleList","splice","back","window","history","go","_this3","findCouponRuleList","trademarkList","_this4","getById","querySkuSearch","queryString","cb","findSkuInfoByKeyword","selectSkuData","removeSkuDataById","selectCategory","categoryId","_this5","removeCateDataById"],"sources":["src/views/activity/couponInfo/rule.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n\n    <h4>优惠券信息</h4>\n    <table class=\"table table-striped table-condenseda table-bordered\" width=\"100%\">\n      <tbody>\n      <tr>\n        <th width=\"15%\">优惠券名称</th>\n        <td width=\"35%\"><b style=\"font-size: 14px\">{{ couponInfo.couponName }}</b></td>\n        <th width=\"15%\">优惠券类型</th>\n        <td width=\"35%\">\n          {{ couponInfo.couponTypeString }}\n        </td>\n      </tr>\n      <tr>\n        <th>发行数量</th>\n        <td>{{ couponInfo.publishCount }}</td>\n        <th>每人限领次数</th>\n        <td>{{ couponInfo.perLimit }}</td>\n      </tr>\n      <tr>\n        <th>领取时间</th>\n        <td>{{ couponInfo.startTime }}至{{ couponInfo.endTime }}</td>\n        <th>过期时间</th>\n        <td>{{ couponInfo.expireTime }}</td>\n      </tr>\n      </tbody>\n    </table>\n\n    <h4>添加规则</h4>\n    <el-form label-width=\"140px\" style=\"background: #f9f9f9;padding-top: 15px; padding-bottom: 1px;\">\n      <el-form-item v-if=\"couponInfo.couponType == 'CASH'\" label=\"现金券金额（元）\" style=\"width: 50%;\">\n        <el-input v-model=\"couponInfo.amount\"/>\n      </el-form-item>\n\n      <el-form-item v-if=\"couponInfo.couponType == 'FULL_REDUCTION'\" label=\"满减金额（元）\" style=\"width: 50%;\">\n        <el-input v-model=\"couponInfo.conditionAmount\"/>\n      </el-form-item>\n\n      <el-form-item v-if=\"couponInfo.couponType == 'FULL_REDUCTION'\" label=\"优惠金额（元）\" style=\"width: 50%;\">\n        <el-input v-model=\"couponInfo.amount\"/>\n      </el-form-item>\n    </el-form>\n\n    <h4>优惠券范围选择</h4>\n    <el-form label-width=\"0px\" style=\"background: #f9f9f9;padding-top: 15px;padding-left: 15px; padding-bottom: 1px;\">\n      <el-form-item>\n        <el-radio-group v-model=\"couponInfo.rangeType\">\n          <el-radio label=\"ALL\">通用</el-radio>\n          <el-radio label=\"SKU\">SKU</el-radio>\n          <el-radio label=\"CATEGORY\">分类</el-radio>\n        </el-radio-group>\n      </el-form-item>\n    </el-form>\n\n    <div v-if=\"couponInfo.rangeType == 'SKU'\">\n      <el-dialog title=\"添加范围\" :visible.sync=\"dialogSkduRangVisible\" width=\"490px\">\n        <div style=\"margin-top: 20px;\">\n          <el-form :inline=\"true\" class=\"demo-form-inline\">\n            <el-form-item>\n              <el-autocomplete\n                v-model=\"keyword\"\n                :fetch-suggestions=\"querySkuSearch\"\n                :trigger-on-focus=\"false\"\n                class=\"inline-input\"\n                placeholder=\"请输入关键字，选择活动商品\"\n                value-key=\"skuName\"\n                style=\"width: 400px;\"\n                @select=\"selectSkuData\"\n              />\n            </el-form-item>\n\n            <el-form-item>\n              <el-button type=\"\" @click=\"dialogSkduRangVisible = false\">取消</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </el-dialog>\n      <h4>\n        优惠券范围列表&nbsp;&nbsp;&nbsp;\n        <el-button type=\"\" size=\"mini\" @click=\"dialogSkduRangVisible = true\">添加优惠券范围</el-button>\n      </h4>\n      <el-table\n        v-loading=\"listLoading\"\n        :data=\"skuInfoList\"\n        border\n        fit\n        highlight-current-row>\n\n        <el-table-column\n          label=\"序号\"\n          width=\"70\"\n          align=\"center\">\n          <template slot-scope=\"scope\">\n            {{ scope.$index + 1 }}\n          </template>\n        </el-table-column>\n\n        <el-table-column prop=\"id\" label=\"sku ID\" width=\"100\"/>\n        <el-table-column prop=\"skuName\" label=\"sku名称\" width=\"120\"/>\n        <el-table-column prop=\"skuCode\" label=\"sku编号\" />\n\n        <el-table-column label=\"操作\" width=\"200\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-button type=\"text\" size=\"mini\" @click=\"removeSkuDataById(scope.$index)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n\n    <div v-if=\"couponInfo.rangeType == 'CATEGORY'\">\n      <el-dialog title=\"添加范围\" :visible.sync=\"dialogCateRangVisible\" width=\"490px\">\n        <div style=\"margin-top: 20px;\">\n          <el-form :inline=\"true\" class=\"demo-form-inline\">\n            <el-select placeholder=\"请选择\" style=\"width: 300px\" @change=\"selectCategory\">\n              <el-option\n                v-for=\"category in selectCategoryList\"\n                :key=\"category.id\"\n                :label=\"category.name\"\n                :value=\"category.id\"/>\n            </el-select>\n\n            <el-form-item>\n              <el-button type=\"\" @click=\"dialogCateRangVisible = false\">取消</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </el-dialog>\n      <h4>\n        优惠券范围列表&nbsp;&nbsp;&nbsp;\n        <el-button type=\"\" size=\"mini\" @click=\"dialogCateRangVisible = true\">添加优惠券范围</el-button>\n      </h4>\n      <el-table\n        v-loading=\"listLoading\"\n        :data=\"categoryList\"\n        border\n        fit\n        highlight-current-row>\n\n        <el-table-column\n          label=\"序号\"\n          width=\"70\"\n          align=\"center\">\n          <template slot-scope=\"scope\">\n            {{ scope.$index + 1 }}\n          </template>\n        </el-table-column>\n\n        <el-table-column prop=\"id\" label=\"分类ID\" width=\"100\"/>\n        <el-table-column prop=\"name\" label=\"名称\" />\n\n        <el-table-column label=\"操作\" width=\"200\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-button size=\"mini\" type=\"text\" @click=\"removeCateDataById(scope.$index)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n\n    <div v-if=\"couponInfo.rangeType == 'ALL'\">\n      <span>通用</span>\n    </div>\n\n    <div style=\"margin-top: 15px;\">\n      <el-form label-width=\"0px\">\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"save\">保存</el-button>\n          <el-button @click=\"back\">返回</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport api from '@/api/activity/couponInfo'\nimport activityInfoApi from '@/api/activity/activityInfo'\nimport categoryApi from '@/api/product/category'\n\nexport default {\n  data() {\n    return {\n      listLoading: false, // 数据是否正在加载\n\n      couponInfo: {},\n      saveBtnDisabled: false,\n\n      // 优惠券范围：SPU\n      dialogSkduRangVisible: false,\n      keyword: '',\n      skuInfoList: [],\n\n      // 优惠券范围：三级分类\n      dialogCateRangVisible: false,\n      categoryList: [],\n      selectCategoryList: []\n    }\n  },\n\n  // 监听器\n  watch: {\n    $route(to, from) {\n      console.log('路由变化......')\n      console.log(to)\n      console.log(from)\n      this.init()\n    }\n  },\n\n  // 生命周期方法（在路由切换，组件不变的情况下不会被调用）\n  created() {\n    console.log('form created ......')\n    this.init()\n  },\n\n  methods: {\n\n    // 表单初始化\n    init() {\n      const couponId = this.$route.params.id\n      // 获取优惠券信息\n      this.fetchDataById(couponId)\n\n      // 获取优惠券规则与范围信息\n      this.fetchRuleDataById(couponId)\n\n      this.fetchCategoryList()\n    },\n\n    fetchCategoryList() {\n      categoryApi.findAllList().then(response => {\n        this.selectCategoryList = response.data\n      })\n    },\n\n    // 提交保存数据\n    save() {\n      let rangeDesc = '可购买'\n      const couponRangeList = []\n      if (this.couponInfo.rangeType === 'SKU') {\n        this.skuInfoList.forEach(function(item) {\n          rangeDesc += '：'\n          couponRangeList.push({\n            rangeType: 'SKU',\n            rangeId: item.id\n          })\n          rangeDesc += item.spuName + ','\n        })\n      }\n      if (this.couponInfo.rangeType === 'CATEGORY') {\n        rangeDesc += '分类：'\n        this.categoryList.forEach(function(item) {\n          couponRangeList.push({\n            rangeType: 'CATEGORY',\n            rangeId: item.id\n          })\n          rangeDesc += item.name + ','\n        })\n      }\n      if (this.couponInfo.rangeType === 'ALL') {\n        rangeDesc +=  '全场通用,'\n      }\n      if (rangeDesc.length > 3) {\n        rangeDesc = rangeDesc.substring(0, rangeDesc.length - 1)\n      } else {\n        rangeDesc = this.couponInfo.couponName\n      }\n      const ruleData = {\n        couponId: this.couponInfo.id,\n        rangeType: this.couponInfo.rangeType,\n        amount: this.couponInfo.amount,\n        conditionAmount: this.couponInfo.conditionAmount,\n        couponRangeList: couponRangeList,\n        rangeDesc: rangeDesc\n      }\n\n      api.saveCouponRule(ruleData).then(response => {\n        this.$message.success(response.message)\n        this.$router.push({ path: '/activity/couponInfo/list' })\n      })\n    },\n\n    removeDataById(index) {\n      this.activityRuleList.splice(index, 1)\n    },\n\n    back() {\n      // this.$router.push({ path: '/activity/couponInfo/list' })\n      window.history.go(-1)\n    },\n\n    fetchRuleDataById(id) {\n      api.findCouponRuleList(id).then(response => {\n\n        this.skuInfoList = response.data.skuInfoList || []\n        this.categoryList = response.data.categoryList || []\n        this.trademarkList = response.data.trademarkList || []\n      })\n    },\n\n    // 根据id查询记录\n    fetchDataById(id) {\n      api.getById(id).then(response => {\n        //\n        this.couponInfo = response.data\n      })\n    },\n\n    querySkuSearch(queryString, cb) {\n      console.log(queryString)\n      console.log(cb)\n\n      activityInfoApi.findSkuInfoByKeyword(queryString).then(response => {\n        // 调用 callback 返回建议列表的数据\n        cb(response.data)\n      })\n    },\n\n    selectSkuData(item) {\n\n      this.skuInfoList.push(item)\n      this.dialogSkduRangVisible = false\n    },\n\n    removeSkuDataById(index) {\n      this.skuInfoList.splice(index, 1)\n    },\n\n    selectCategory(categoryId) {\n      console.log(categoryId)\n      categoryApi.getById(categoryId)\n          .then(response => {\n              this.categoryList.push({\n                id: categoryId,\n                name: response.data.name\n              })\n          })\n      this.dialogCateRangVisible = false\n    },\n\n    removeCateDataById(index) {\n      this.categoryList.splice(index, 1)\n    }\n  }\n}\n</script>\n<style>\n  .app-container h4 {\n    color: #606266;\n  }\n</style>\n"],"mappings":"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"}]}